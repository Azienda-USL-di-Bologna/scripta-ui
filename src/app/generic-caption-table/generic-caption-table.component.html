<div class="generic-caption-table-row">
  <div class="left-content">
    <div class="p-d-flex">
      <!-- RICERCA -->
      <span class="box-ricerca">
        <span class="p-input-icon-left p-ml-auto">
          <i class="pi pi-search"></i>
          <input #inputGobalFilter pInputText 
            [disabled]="!configuration.searchBox"
            type="text" 
            (input)="referenceTableComponent.removeSort(); referenceTableComponent.applyFilterGlobal($event, 'equals')" 
            placeholder="Ricerca.." />
        </span>
        <!-- BOTTONE AGGIORNA RICERCA -->
        <button pButton 
          [disabled]="!configuration.searchBox"
          class="p-button-outlined refresh-button" 
          icon="pi pi-filter" 
          pTooltip="Applica i filtri. Aggiorna"
          aria-label="Applica i filtri"
          tooltipPosition="bottom"
          (click)="referenceTableComponent.resetPaginationAndLoadData()">
        </button>
        <!-- BOTTONE RESETTA RICERCA -->
        <button pButton 
          [disabled]="!configuration.searchBox"
          class="p-button-outlined alarm-button" 
          icon="pi pi-filter-slash" 
          pTooltip="Ripristina filtri iniziali"
          aria-label="Ripristina filtri iniziali"
          tooltipPosition="bottom"
          (click)="inputGobalFilter.value = ''; referenceTableComponent.clear()">
        </button>
      </span>
      <!-- ELENCO TAB -->
      <p-selectButton *ngIf="configuration.selectButtons"
        class="tabs"
        [options]="selectButtonsComponent.selectButtonItems" 
        [(ngModel)]="selectButtonsComponent.selectedButtonItem" 
        optionLabel="label"
        (onOptionClick)="selectButtonsComponent.onSelectButtonItemSelection($event)">
      </p-selectButton>
      <!-- Conteggio elementi trovati -->
      <span *ngIf="configuration.rowCount"
        class="row-count">
        <span *ngIf="!referenceTableComponent.rowCountInProgress && referenceTableComponent.rowCount >= 0">
          Trovati {{referenceTableComponent.rowCount}} {{configuration.component === "DOCS_LIST" ? 'documenti' : 'fascicoli'}}
        </span>
        <span *ngIf="referenceTableComponent.rowCountInProgress">
          <p-progressSpinner 
            [style]="{width: '2em', height: '2em', marginRight: '7px'}"
            strokeWidth="8" 
            fill="#FFFFFF" 
            animationDuration=".5s">
          </p-progressSpinner>
        </span>
      </span>
    </div>
  </div>
  <div class="right-content">
    <!-- SPINNER GENERICO DA ATTIVARE ALL'OCCORRENZA, IN PARITCOLARE PER OPERAZIONI ATTIVATE DAI BOTTONI DELLA PARTE DESTRA -->
    <span *ngIf="referenceTableComponent.rightContentProgressSpinner || functionalButtonsComponent?.rightContentProgressSpinner">
      <p-progressSpinner 
        [style]="{width: '2em', height: '2em', marginRight: '7px'}"
        strokeWidth="8" 
        fill="#FFFFFF" 
        animationDuration=".5s">
      </p-progressSpinner>
    </span>

    <i *ngIf="configuration.showIconArchiveClosed"
      class="pi pi-lock lucchettoChiuso" 
      [pTooltip]="'Fascicolo chiuso'" 
      tooltipPosition="bottom">
    </i>

    <!-- BOTTONE PREFERITO -->
    <span *ngIf="configuration.preferitoButton">
      <i 
        class="pi p-mr-2 p-button-icon-only preferitoStar"
        (click)="functionalButtonsComponent.updateOrAddPreferito()" 
        [ngClass]="{'pi-star-fill': functionalButtonsComponent.archivioPreferito, 'pi-star empty': !functionalButtonsComponent.archivioPreferito}"
        [pTooltip]="functionalButtonsComponent.archivioPreferito ? 'Rimuovi dai preferiti' : 'Aggiungi ai preferiti'"
        [attr.aria-label]="functionalButtonsComponent.archivioPreferito ? 'Rimuovi dai preferiti' : 'Aggiungi ai preferiti'"
        tooltipPosition="bottom">
      </i>
    </span>
    <!-- BOTTONE NUOVO ARCHIVIO [disabled] = "archivio.canCreateSottoarchivio()"-->
    <span *ngIf="configuration.newArchivio && functionalButtonsComponent.newArchivoButton">
      <button
        type="button" 
        pButton 
        pRipple 
        [disabled]="!functionalButtonsComponent.newArchivoButton.enable"
        icon="pi pi-plus" 
        (click)="functionalButtonsComponent.newArchivoButton.aziendeItems.length > 1 ? 
          aziendaSelection.toggle($event) : 
          functionalButtonsComponent.newArchivoButton.aziendeItems[0].command()" 
        class="p-mr-2" 
        [pTooltip]="functionalButtonsComponent.newArchivoButton.tooltip"
        [attr.aria-label]="functionalButtonsComponent.newArchivoButton.tooltip"
        tooltipPosition="bottom">
      </button>
      <p-menu
        appendTo="body"
        #aziendaSelection
        [model]="functionalButtonsComponent.newArchivoButton.aziendeItems"
        [popup]="true">
      </p-menu>
    </span>
    <!-- BOTTONE UPLOAD DOCUMENT -->
    <!--fileUploaderDocumentsAuto.clear() serve a svuotare il componente altrimenti si carica sempre lo stesso file--> 
    <span *ngIf="configuration.uploadDocument && functionalButtonsComponent.uploadDocumentButton" class="span-fileUpload-button">
      <p-fileUpload #fileUploaderDocumentsAuto
        chooseIcon="pi pi-upload"
        pTooltip="Carica documenti nell'archivio"
        class="upload-document-button"
        multiple="true"
        [disabled]="!functionalButtonsComponent.uploadDocumentButton.enable"
        mode="basic" 
        name="document[]"
        maxFileSize="5000000" 
        [customUpload]="true"
        [auto]="true"
        (uploadHandler)="functionalButtonsComponent.uploadDocument($event);fileUploaderDocumentsAuto.clear()">
      </p-fileUpload>
    </span>
    <!-- PROGRESS SPINNER -->
    <span *ngIf="configuration.exportButton">
      <!-- BOTTONE ESPORTA -->
      <button
        type="button" 
        pButton 
        pRipple 
        icon="pi pi-file-o" 
        (click)="referenceTableComponent.exportCSV(referenceTableComponent.dataTable)" 
        class="p-mr-2" 
        pTooltip="CSV"
        aria-label="Scarica il csv della tabella"
        tooltipPosition="bottom">
      </button>
      <!-- BOTTONE TIP -->
      <button *ngIf="canUseTip"
        type="button" 
        pButton 
        pRipple 
        icon="pi pi-file" 
        (click)="show()" 
        class="p-mr-2" 
        pTooltip="TIP"
        aria-label="Tool di importazione pregressi"
        tooltipPosition="bottom">
      </button>
      <!-- <p-menu
        #exportCsvSelection
        [model]="functionalButtonsComponent.newArchivoButton.aziendeItems"
        [popup]="true">
      </p-menu> -->
    </span>
    <!-- SELEZIONE COLONNE -->
    <p-multiSelect #ms
      *ngIf="configuration.selectableColumns && !accessibile"
      [options]="referenceTableComponent.selectableColumns" 
      [(ngModel)]="referenceTableComponent.selectedColumns" 
      (onChange)="referenceTableComponent.onChangeSelectedColumns($event)"
      optionLabel="header" 
      optionDisabled="selectionDisabled"
      [showHeader]="false"
      selectedItemsLabel="{0} colonne selezionate"
      [style]="{minWidth: '250px', maxWidth: '250px'}" 
      placeholder="Scegli le colonne da visualizzare"
      aria-label="Scegli le colonne da visualizzare">
      <ng-template let-column pTemplate="item"  >
        <div class="column-item">
          <span >{{column.header}}</span>
        </div>
      </ng-template>
    </p-multiSelect>
  </div>
</div>
